<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>x4 Pay ‚Äî Device Scanner (Web)</title>
  <!-- Tailwind via CDN for quick prototype -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* small niceties for this demo */
    body { background: #000; color: #fff; }
    .glass { background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.08); backdrop-filter: blur(8px); }
  </style>
</head>
<body class="min-h-screen flex flex-col">
  <!-- Top header -->
  <header class="w-full py-4 px-4 border-b border-white/10 glass">
    <div class="max-w-4xl mx-auto flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-2xl bg-white/8 flex items-center justify-center">
          <img src="../assets/logo.png" alt="x4 Pay Logo" style="width: 24px; height: 24px; object-fit: contain;" />
        </div>
        <div>
          <div class="flex items-center">
            <img src="../assets/banner.png" alt="x4 Pay" style="height: 24px; object-fit: contain;" />
          </div>
          <div class="text-xs text-white/60">discover devices</div>
        </div>
      </div>
      <nav class="flex items-center gap-3">
        <button id="settingsBtn" class="text-sm text-white/60">Settings</button>
      </nav>
    </div>
  </header>

  <!-- Main content -->
  <main class="flex-1 overflow-auto">
    <div class="max-w-4xl mx-auto p-4">
      <!-- Device Card -->
      <section class="glass rounded-3xl p-6 mb-6">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
          <div class="flex items-center gap-4">
            <div class="w-16 h-16 rounded-2xl bg-white/8 flex items-center justify-center text-2xl">‚äï</div>
            <div>
              <h2 class="text-xl font-semibold">Device Scanner</h2>
              <p class="text-sm text-white/60">Discover and connect to nearby payment devices</p>
            </div>
          </div>

          <div class="flex items-center gap-3">
            <div id="statusDot" class="w-3 h-3 rounded-full bg-white/30"></div>
            <div id="statusText" class="text-base">Ready to tap</div>
            <button id="scanBtn" class="ml-4 rounded-2xl px-4 py-2.5 border border-white/15 bg-black text-white font-semibold">Scan Devices</button>
          </div>
        </div>
      </section>

      <!-- Device list / scanner area -->
      <section class="mb-6">
        <div class="mb-3 text-sm text-white/60">Available Devices (<span id="deviceCount">0</span>)</div>
        <div id="deviceList" class="grid gap-3">
          <!-- devices will be injected here -->
        </div>
      </section>

      <!-- Empty state -->
      <div id="emptyState" class="items-center justify-center py-12 text-center text-white/50">
        <div class="mb-4 h-12 w-12 mx-auto rounded-full bg-white/10 flex items-center justify-center">‚óØ</div>
        <div class="text-base font-medium text-white mb-2">No devices nearby</div>
        <div class="max-w-md mx-auto text-sm">Make sure your device is discoverable and try scanning again.</div>
      </div>

      <!-- Log area -->
      <section class="mt-6">
        <div class="text-xs text-white/50 mb-2">Log</div>
        <pre id="log" class="text-xs p-3 rounded-md bg-black/60 border border-white/6 max-h-48 overflow-auto">Started.</pre>
      </section>
    </div>
  </main>

  <!-- Bottom navigation -->
  <footer class="w-full py-3 border-t border-white/8 glass">
    <div class="max-w-4xl mx-auto px-4 flex justify-between">
      <button class="flex flex-col items-center text-white/80 text-xs">
        <div class="w-6 h-6 flex items-center justify-center">üè†</div>
        Home
      </button>
      <button class="flex flex-col items-center text-white/80 text-xs">
        <div class="w-6 h-6 flex items-center justify-center">üí≥</div>
        Wallet
      </button>
      <button class="flex flex-col items-center text-white text-xs font-semibold">
        <div class="w-12 h-12 -mt-6 bg-white/8 rounded-full flex items-center justify-center shadow-md">‚äï</div>
        Pay
      </button>
      <button class="flex flex-col items-center text-white/80 text-xs">
        <div class="w-6 h-6 flex items-center justify-center">üîß</div>
        Tools
      </button>
      <button class="flex flex-col items-center text-white/80 text-xs">
        <div class="w-6 h-6 flex items-center justify-center">‚öôÔ∏è</div>
        More
      </button>
    </div>
  </footer>

  <script>
    // Simple simulation of scanning and devices
    const deviceListEl = document.getElementById('deviceList');
    const deviceCountEl = document.getElementById('deviceCount');
    const scanBtn = document.getElementById('scanBtn');
    const statusDot = document.getElementById('statusDot');
    const statusText = document.getElementById('statusText');
    const emptyState = document.getElementById('emptyState');
    const logEl = document.getElementById('log');

    let scanning = false;
    let devices = [];

    function appendLog(msg) {
      logEl.textContent += '\n' + msg;
      logEl.scrollTop = logEl.scrollHeight;
    }

    function renderDevices() {
      deviceListEl.innerHTML = '';
      deviceCountEl.textContent = devices.length;
      if (devices.length === 0) {
        emptyState.style.display = 'block';
      } else {
        emptyState.style.display = 'none';
      }

      devices.forEach((d, i) => {
        const card = document.createElement('div');
        card.className = 'flex items-center justify-between p-4 rounded-2xl border border-white/10 bg-white/5';
        card.innerHTML = `
          <div class="flex items-center gap-3">
            <div class="h-10 w-10 rounded-full bg-white/10 flex items-center justify-center">‚ñ∑</div>
            <div>
              <div class="text-sm font-medium">${d.name}</div>
              <div class="font-mono text-xs text-white/50">${d.id.slice(0,8)}...${d.id.slice(-4)}</div>
            </div>
          </div>
          <div class="flex items-center gap-3">
            <div class="text-xs text-white/40">${d.rssi}</div>
            <button class="px-3 py-1 rounded-2xl border border-white/15 bg-black text-white" onclick="connectDevice(${i})">Connect</button>
          </div>
        `;
        deviceListEl.appendChild(card);
      });
    }

    function randomId() {
      return 'dev_' + Math.random().toString(36).slice(2, 12);
    }

    function startScan() {
      if (scanning) return stopScan();
      scanning = true;
      scanBtn.textContent = 'Scanning...';
      statusDot.classList.remove('bg-white/30');
      statusDot.classList.add('bg-white/80');
      statusText.textContent = 'Scanning...';
      appendLog('Scanning...');

      // simulate finding devices over 5 seconds
      let found = 0;
      const interval = setInterval(() => {
        if (found >= 3) {
          clearInterval(interval);
          scanning = false;
          scanBtn.textContent = 'Scan Devices';
          statusText.textContent = devices.length ? 'Devices found' : 'No devices';
          return;
        }
        const rssi = Math.floor(Math.random()*40) - 80; // -80..-40
        devices.push({ id: randomId(), name: 'Device ' + (devices.length+1), rssi });
        appendLog('Device discovered: ' + devices[devices.length-1].name + ' RSSI: ' + rssi);
        renderDevices();
        found++;
      }, 900);
    }

    function stopScan() {
      scanning = false;
      scanBtn.textContent = 'Scan Devices';
      statusDot.classList.remove('bg-white/80');
      statusDot.classList.add('bg-white/30');
      statusText.textContent = 'Ready to tap';
      appendLog('Scan stopped.');
    }

    function connectDevice(index) {
      const dev = devices[index];
      appendLog('Connecting to ' + dev.name + '...');
      statusDot.classList.remove('bg-white/30');
      statusDot.classList.add('bg-white/80');
      statusText.textContent = 'Connected';
      // For demo, open a simple modal with device info (alert)
      setTimeout(() => {
        alert('Connected to ' + dev.name + ' (id: ' + dev.id + ')');
      }, 500);
    }

    scanBtn.addEventListener('click', startScan);

    // initial render
    renderDevices();
  </script>
</body>
</html>
